Version 4
SHEET 1 5324 3112
WIRE -192 -320 -208 -320
WIRE -48 -320 -48 -336
WIRE -48 -320 -112 -320
WIRE -192 -240 -208 -240
WIRE -48 -240 -112 -240
WIRE -48 -208 -48 -240
WIRE 800 32 800 -16
WIRE 480 64 448 64
WIRE 608 64 560 64
WIRE 800 160 800 112
WIRE 512 192 512 160
WIRE 336 208 304 208
WIRE 448 208 448 64
WIRE 448 208 416 208
WIRE 480 208 448 208
WIRE -912 224 -912 208
WIRE -512 224 -512 192
WIRE 608 224 608 64
WIRE 608 224 544 224
WIRE 624 224 608 224
WIRE 896 224 896 192
WIRE -912 240 -912 224
WIRE 480 240 464 240
WIRE -320 256 -336 256
WIRE -208 256 -240 256
WIRE -48 256 -80 256
WIRE 80 256 48 256
WIRE 512 272 512 256
WIRE -64 288 -80 288
WIRE -48 288 -64 288
WIRE 80 288 48 288
WIRE 464 288 464 240
WIRE 512 288 512 272
WIRE 192 304 80 304
WIRE 336 304 304 304
WIRE 448 304 448 208
WIRE 448 304 416 304
WIRE -48 320 -80 320
WIRE 80 320 80 304
WIRE 80 320 48 320
WIRE 624 336 624 224
WIRE 640 336 624 336
WIRE 800 336 800 240
WIRE 800 336 720 336
WIRE 816 336 800 336
WIRE 896 336 896 304
WIRE -512 352 -512 336
WIRE -320 352 -336 352
WIRE -208 352 -240 352
WIRE -48 352 -80 352
WIRE 80 352 48 352
WIRE -768 368 -768 336
WIRE -512 368 -512 352
WIRE 80 384 80 352
WIRE 192 384 80 384
WIRE 592 768 416 768
WIRE 704 768 672 768
WIRE 32 784 -144 784
WIRE 144 784 112 784
WIRE 704 832 704 768
WIRE 704 832 544 832
WIRE 144 848 144 784
WIRE 144 848 -16 848
WIRE 624 896 624 880
WIRE 64 912 64 896
WIRE 544 912 544 832
WIRE 592 912 544 912
WIRE -16 928 -16 848
WIRE 32 928 -16 928
WIRE 704 928 704 832
WIRE 704 928 656 928
WIRE 144 944 144 848
WIRE 144 944 96 944
WIRE 320 944 144 944
WIRE 416 944 416 768
WIRE 416 944 384 944
WIRE 448 944 416 944
WIRE 560 944 512 944
WIRE 592 944 560 944
WIRE -272 960 -288 960
WIRE -240 960 -272 960
WIRE -144 960 -144 784
WIRE -144 960 -176 960
WIRE -112 960 -144 960
WIRE 0 960 -48 960
WIRE 32 960 0 960
WIRE 624 976 624 960
WIRE 64 992 64 976
WIRE 560 992 560 944
WIRE 0 1008 0 960
WIRE 560 1344 384 1344
WIRE 672 1344 624 1344
WIRE 32 1360 -144 1360
WIRE 144 1360 96 1360
WIRE 672 1408 672 1344
WIRE 672 1408 512 1408
WIRE 144 1424 144 1360
WIRE 144 1424 -16 1424
WIRE 592 1472 592 1456
WIRE 64 1488 64 1472
WIRE 512 1488 512 1408
WIRE 560 1488 512 1488
WIRE -16 1504 -16 1424
WIRE 32 1504 -16 1504
WIRE 672 1504 672 1408
WIRE 672 1504 624 1504
WIRE 144 1520 144 1424
WIRE 144 1520 96 1520
WIRE 272 1520 144 1520
WIRE 384 1520 384 1344
WIRE 384 1520 352 1520
WIRE 400 1520 384 1520
WIRE 528 1520 480 1520
WIRE 560 1520 528 1520
WIRE -256 1536 -288 1536
WIRE -144 1536 -144 1360
WIRE -144 1536 -176 1536
WIRE -128 1536 -144 1536
WIRE 0 1536 -48 1536
WIRE 32 1536 0 1536
WIRE 592 1552 592 1536
WIRE 64 1568 64 1552
WIRE 528 1568 528 1520
WIRE 0 1584 0 1536
WIRE 528 1648 528 1632
WIRE 0 1664 0 1648
WIRE 928 1968 912 1968
WIRE 848 1984 704 1984
WIRE 928 2000 912 2000
WIRE 992 2000 944 2000
WIRE 848 2016 832 2016
WIRE 944 2032 944 2000
WIRE 944 2032 912 2032
WIRE 320 2080 320 2064
WIRE 400 2080 352 2080
WIRE -160 2096 -176 2096
WIRE -96 2096 -160 2096
WIRE -64 2096 -96 2096
WIRE 48 2096 16 2096
WIRE 96 2096 48 2096
WIRE 288 2096 176 2096
WIRE 400 2112 352 2112
WIRE 48 2128 48 2096
WIRE 288 2128 272 2128
WIRE 832 2128 832 2016
WIRE 944 2128 944 2032
WIRE 944 2128 912 2128
WIRE 432 2144 352 2144
WIRE 512 2144 512 2112
WIRE 512 2144 432 2144
WIRE 320 2160 320 2144
WIRE 512 2160 512 2144
WIRE 832 2176 832 2128
WIRE 272 2208 272 2128
WIRE 432 2208 432 2144
WIRE 432 2208 272 2208
WIRE 272 2272 256 2272
WIRE 304 2272 304 2256
WIRE 832 2272 832 2256
WIRE 512 2288 512 2240
WIRE 512 2288 336 2288
WIRE 48 2304 48 2192
WIRE 208 2304 48 2304
WIRE 272 2304 256 2304
WIRE 368 2320 336 2320
WIRE 512 2320 512 2288
WIRE 48 2336 48 2304
WIRE 208 2336 208 2304
WIRE 272 2336 208 2336
WIRE 304 2352 304 2336
WIRE 208 2416 208 2336
WIRE 368 2416 368 2320
WIRE 368 2416 208 2416
WIRE -96 2432 -96 2096
WIRE 48 2432 48 2416
WIRE 48 2432 -32 2432
WIRE 112 2432 48 2432
WIRE 176 2432 176 2096
WIRE 512 2464 512 2400
FLAG -512 304 0
FLAG -512 448 0
FLAG -512 192 +Vs
FLAG -512 352 -Vs
FLAG -80 320 +Vs
FLAG -80 352 -Vs
FLAG 64 896 +Vs
FLAG 64 992 -Vs
FLAG 0 1088 0
FLAG 144 944 HPF_1stStage
FLAG -912 320 0
FLAG -912 224 Test_In
FLAG 624 880 +Vs
FLAG 624 976 -Vs
FLAG 560 1072 0
FLAG 704 928 HPF_Out
FLAG 64 1472 +Vs
FLAG 64 1568 -Vs
FLAG 0 1664 0
FLAG 144 1520 LPF_1stStage
FLAG -288 1536 HPF_Out
FLAG 592 1456 +Vs
FLAG 592 1552 -Vs
FLAG 528 1648 0
FLAG 672 1504 LPF_Out
FLAG 512 2464 0
FLAG 512 2112 Notch_Out
FLAG 48 2096 Vb
FLAG 400 2080 +Vs
FLAG 400 2112 -Vs
FLAG 256 2304 -Vs
FLAG 256 2272 +Vs
FLAG 48 2432 Va
FLAG -48 -144 0
FLAG -48 -320 RC+
FLAG -48 -240 RC-
FLAG 80 256 EEGRaw
FLAG -208 256 RC+
FLAG -208 352 RC-
FLAG 464 288 0
FLAG 512 272 -Vs
FLAG 512 160 +Vs
FLAG 608 224 DRLout
FLAG 800 -16 In+
FLAG 896 192 In-
FLAG 800 336 Body
FLAG 304 208 In+
FLAG 304 304 In-
FLAG -336 256 In+
FLAG -336 352 In-
FLAG -80 256 In+
FLAG -64 288 In-
FLAG 80 288 0
FLAG -272 960 Test_In
FLAG 992 2000 AnalogOut
FLAG 832 2272 0
FLAG 928 1968 +Vs
FLAG 928 2000 -Vs
FLAG 704 1984 Test_In
FLAG -160 2096 LPF_Out
FLAG -768 448 0
SYMBOL AD620 0 304 R0
SYMATTR InstName U1
SYMBOL Voltage -512 352 R0
SYMATTR InstName V1
SYMATTR Value -9
SYMBOL Voltage -512 208 R0
SYMATTR InstName V2
SYMATTR Value 9
SYMBOL Res 176 288 R0
SYMATTR InstName GainR
SYMATTR Value {Rg}
SYMBOL AD712 64 880 R0
SYMATTR InstName U2
SYMBOL Cap -176 944 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {C1}
SYMBOL Res 16 1104 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R1
SYMATTR Value {R2}
SYMBOL Res 16 800 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value {R1}
SYMBOL Cap -48 944 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value {C2}
SYMBOL Voltage -912 224 R0
SYMATTR InstName V5
SYMATTR Value ""
SYMATTR Value2 AC 1
SYMBOL AD712 624 864 R0
SYMATTR InstName U3
SYMBOL Cap 384 928 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value {C1}
SYMBOL Res 576 1088 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value {R2}
SYMBOL Res 576 784 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R4
SYMATTR Value {R1}
SYMBOL Cap 512 928 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value {C2}
SYMBOL AD712 64 1456 R0
SYMATTR InstName U4
SYMBOL Res -160 1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {R5}
SYMBOL Res -32 1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {R6}
SYMBOL Cap -16 1584 R0
SYMATTR InstName C5
SYMATTR Value {C5}
SYMBOL Cap 96 1344 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value {C6}
SYMBOL AD712 592 1440 R0
SYMATTR InstName U5
SYMBOL Res 368 1504 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value {R5}
SYMBOL Res 496 1504 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {R6}
SYMBOL Cap 512 1568 R0
SYMATTR InstName C7
SYMATTR Value {C5}
SYMBOL Cap 624 1328 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C8
SYMATTR Value {C6}
SYMBOL Res 32 2080 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value {R9}
SYMBOL Res 192 2080 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {R10}
SYMBOL Cap 32 2128 R0
SYMATTR InstName C9
SYMATTR Value {C9}
SYMBOL Res 32 2320 R0
SYMATTR InstName R11
SYMATTR Value {R11}
SYMBOL Cap -32 2416 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C10
SYMATTR Value {C10}
SYMBOL Cap 176 2416 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C11
SYMATTR Value {C11}
SYMBOL Res 496 2144 R0
SYMATTR InstName R12
SYMATTR Value {R12}
SYMBOL Res 496 2304 R0
SYMATTR InstName R13
SYMATTR Value {R13}
SYMBOL TL072 320 2112 R0
WINDOW 0 0 -56 Top 2
SYMATTR InstName U8
SYMBOL TL072 304 2304 M0
WINDOW 0 0 -56 Top 2
SYMATTR InstName U9
SYMBOL Res -96 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value {R17}
SYMBOL Res -96 -256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value {R17}
SYMBOL Cap -64 -400 R0
SYMATTR InstName C15
SYMATTR Value {C16}
SYMBOL Cap -64 -208 R0
SYMATTR InstName C16
SYMATTR Value {C16}
SYMBOL Res -224 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value {R17}
SYMBOL Res -224 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value {R17}
SYMBOL Res 432 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value {R17}
SYMBOL Res 432 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value {R17}
SYMBOL Res 576 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 47k
SYMBOL AD712 512 160 R0
SYMATTR InstName U6
SYMBOL Res 736 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 300k
SYMBOL bv 800 16 R0
SYMATTR InstName B1
SYMATTR Value V={EEGamp*sin(2*pi*EEGfreq1*time) + CMamp*sin(2*pi*CMfreq*time) + deltaAmp*CMamp*sin(2*pi*CMfreq*time)}
SYMBOL bv 896 208 R0
SYMATTR InstName B2
SYMATTR Value V={-EEGamp*sin(2*pi*EEGfreq1*time) + CMamp*sin(2*pi*CMfreq*time)}
SYMBOL Res 784 144 R0
WINDOW 3 36 76 VRight 2
SYMATTR Value {BodyRes}
SYMATTR InstName R24
SYMBOL Res 912 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value {BodyRes}
SYMBOL Res 928 2112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value {R21}
SYMBOL Res 848 2272 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R22
SYMATTR Value {R22}
SYMBOL TL072 880 2000 R0
WINDOW 0 0 -56 Top 2
SYMATTR InstName U7
SYMBOL Voltage -768 352 R0
SYMATTR InstName V3
SYMATTR Value SINE(0 1.65 50)
TEXT -232 112 Left 2 !.param Rg = (49.4k/Gain)+1
TEXT -232 72 Left 2 !.param Gain = 30
TEXT -336 688 Left 2 !.param C1 = 1u
TEXT -336 712 Left 2 !.param C2 = 1u
TEXT -336 736 Left 2 !.param R1 = 100k
TEXT -336 760 Left 2 !.param R2 = 220k
TEXT -944 128 Left 2 !.ac dec 101 0.01 10Meg
TEXT -968 32 Left 5 ;Testing Equations
TEXT -336 616 Left 4 ;HPF
TEXT -240 -24 Left 4 ;EEG RAW
TEXT -344 1312 Left 2 !.param R5 = 5.1k
TEXT -344 1336 Left 2 !.param R6 = 330
TEXT -344 1360 Left 2 !.param C6 = 10u
TEXT -344 1384 Left 2 !.param C5 = 1u
TEXT -312 1224 Left 4 ;LPF
TEXT -328 1944 Left 2 !.param R9 = R
TEXT -328 1888 Left 2 !.param R = 1.47k
TEXT -328 1912 Left 2 !.param C = 2.2u
TEXT -328 1968 Left 2 !.param R10 = R
TEXT -328 1992 Left 2 !.param R11 =  680
TEXT -328 2016 Left 2 !.param C10 = C
TEXT -328 2040 Left 2 !.param C11 = C
TEXT -328 2064 Left 2 !.param C9 = 4.7u
TEXT -328 1840 Left 4 ;BandStop - Notch
TEXT -144 1888 Left 2 !.param R12 = 300k
TEXT -144 1912 Left 2 !.param R13 = 1.47meg
TEXT -744 224 Left 2 ;.tran 0 100m 0 100u
TEXT -184 936 Left 2 ;+
TEXT -248 936 Left 2 ;-
TEXT -56 936 Left 2 ;-
TEXT -120 936 Left 2 ;+
TEXT 312 920 Left 2 ;-
TEXT 384 920 Left 2 ;+
TEXT 440 920 Left 2 ;+
TEXT 512 920 Left 2 ;-
TEXT 1064 -456 Left 2 !.param EEGamp = 50u\n.param EEGfreq1 = 20\n.param CMamp  = 100m\n.param CMfreq = 50\n.param NoiseAmp = 10u\n.param deltaAmp = 0.01*CMamp
TEXT 1328 -464 Left 2 ;50 uV eeg signal
TEXT 1328 -440 Left 2 ;eeg signal frequncy 10Hz
TEXT 1328 -416 Left 2 ;Common Mode Noise (CMN) Amplitude 250mV
TEXT 1328 -392 Left 2 ;CMN frequency 50Hz
TEXT 1328 -368 Left 2 ;random noise amplitude 10uV
TEXT 104 64 Left 2 !.param R17 = 10k
TEXT 104 88 Left 2 !.param C16 = 200p
TEXT 104 40 Left 2 !.param R18 = 100k
TEXT 528 -200 Left 2 !.param BodyRes = 30k
TEXT 856 1856 Left 2 !.parameter R21 = 50k
TEXT 856 1880 Left 2 !.parameter R22 = 1k
RECTANGLE Normal -376 580 776 1108 2
RECTANGLE Normal -1024 -8 -440 516 2
RECTANGLE Normal -380 1172 748 1716 2
RECTANGLE Normal -380 1800 748 2496 2
RECTANGLE Normal -392 -104 756 560 2
